/*
 * This file is subject to the terms and conditions outlined in the file 'LICENSE' (hint: it's MIT); this file is located in the root directory near the README.md which you should also read.
 *
 * This file is part of the 'Adama' project which is a programming language and document store for board games; however, it can be so much more.
 *
 * See http://www.adama-lang.org/ for more information.
 *
 * (c) 2020 - 2022 by Jeffrey M. Barber (http://jeffrey.io)
 */
package org.adamalang.web.service;

import java.nio.charset.StandardCharsets;

import java.util.Base64;

public class JavaScriptClient {
  public static final byte[] ADAMA_JS_CLIENT_BYTES = Base64.getDecoder().decode("IWZ1bmN0aW9uKGUsdCl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz10KCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW10sdCk6Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuQWRhbWE9dCgpOmUuQWRhbWE9dCgpfSh0aGlzLChmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgdD17fTtmdW5jdGlvbiBuKHIpe2lmKHRbcl0pcmV0dXJuIHRbcl0uZXhwb3J0czt2YXIgaT10W3JdPXtpOnIsbDohMSxleHBvcnRzOnt9fTtyZXR1cm4gZVtyXS5jYWxsKGkuZXhwb3J0cyxpLGkuZXhwb3J0cyxuKSxpLmw9ITAsaS5leHBvcnRzfXJldHVybiBuLm09ZSxuLmM9dCxuLmQ9ZnVuY3Rpb24oZSx0LHIpe24ubyhlLHQpfHxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHtlbnVtZXJhYmxlOiEwLGdldDpyfSl9LG4ucj1mdW5jdGlvbihlKXsidW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOiJNb2R1bGUifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pfSxuLnQ9ZnVuY3Rpb24oZSx0KXtpZigxJnQmJihlPW4oZSkpLDgmdClyZXR1cm4gZTtpZig0JnQmJiJvYmplY3QiPT10eXBlb2YgZSYmZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciByPU9iamVjdC5jcmVhdGUobnVsbCk7aWYobi5yKHIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLCJkZWZhdWx0Iix7ZW51bWVyYWJsZTohMCx2YWx1ZTplfSksMiZ0JiYic3RyaW5nIiE9dHlwZW9mIGUpZm9yKHZhciBpIGluIGUpbi5kKHIsaSxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0uYmluZChudWxsLGkpKTtyZXR1cm4gcn0sbi5uPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJmUuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiBlLmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIGV9O3JldHVybiBuLmQodCwiYSIsdCksdH0sbi5vPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfSxuLnA9IiIsbihuLnM9MSl9KFtmdW5jdGlvbihlLHQsbil7KGZ1bmN0aW9uKHQpe3ZhciBuPW51bGw7InVuZGVmaW5lZCIhPXR5cGVvZiBXZWJTb2NrZXQ/bj1XZWJTb2NrZXQ6InVuZGVmaW5lZCIhPXR5cGVvZiBNb3pXZWJTb2NrZXQ/bj1Nb3pXZWJTb2NrZXQ6dm9pZCAwIT09dD9uPXQuV2ViU29ja2V0fHx0Lk1veldlYlNvY2tldDoidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz9uPXdpbmRvdy5XZWJTb2NrZXR8fHdpbmRvdy5Nb3pXZWJTb2NrZXQ6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmJiYobj1zZWxmLldlYlNvY2tldHx8c2VsZi5Nb3pXZWJTb2NrZXQpLGUuZXhwb3J0cz1ufSkuY2FsbCh0aGlzLG4oMikpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24ucih0KSxuLmQodCwiUHJvZHVjdGlvbiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGN9KSksbi5kKHQsIlRyZWUiLChmdW5jdGlvbigpe3JldHVybiB1fSkpLG4uZCh0LCJDb25zb2xlTG9nU2VxUmVzcG9uZGVyIiwoZnVuY3Rpb24oKXtyZXR1cm4gZH0pKSxuLmQodCwiVHJlZVBpcGVEYXRhUmVzcG9uc2UiLChmdW5jdGlvbigpe3JldHVybiBhfSkpLG4uZCh0LCJDb25uZWN0aW9uIiwoZnVuY3Rpb24oKXtyZXR1cm4gaH0pKTt2YXIgcj1uKDApLGk9bi5uKHIpLG89ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIG5ldyhufHwobj1Qcm9taXNlKSkoKGZ1bmN0aW9uKGksbyl7ZnVuY3Rpb24gcyhlKXt0cnl7dShyLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGMoZSl7dHJ5e3Uoci50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gdShlKXt2YXIgdDtlLmRvbmU/aShlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBuP3Q6bmV3IG4oKGZ1bmN0aW9uKGUpe2UodCl9KSkpLnRoZW4ocyxjKX11KChyPXIuYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KSl9LHM9ZnVuY3Rpb24oZSx0KXt2YXIgbixyLGksbyxzPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJmlbMF0pdGhyb3cgaVsxXTtyZXR1cm4gaVsxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBvPXtuZXh0OmMoMCksdGhyb3c6YygxKSxyZXR1cm46YygyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKG9bU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksbztmdW5jdGlvbiBjKG8pe3JldHVybiBmdW5jdGlvbihjKXtyZXR1cm4gZnVuY3Rpb24obyl7aWYobil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtzOyl0cnl7aWYobj0xLHImJihpPTImb1swXT9yLnJldHVybjpvWzBdP3IudGhyb3d8fCgoaT1yLnJldHVybikmJmkuY2FsbChyKSwwKTpyLm5leHQpJiYhKGk9aS5jYWxsKHIsb1sxXSkpLmRvbmUpcmV0dXJuIGk7c3dpdGNoKHI9MCxpJiYobz1bMiZvWzBdLGkudmFsdWVdKSxvWzBdKXtjYXNlIDA6Y2FzZSAxOmk9bzticmVhaztjYXNlIDQ6cmV0dXJuIHMubGFiZWwrKyx7dmFsdWU6b1sxXSxkb25lOiExfTtjYXNlIDU6cy5sYWJlbCsrLHI9b1sxXSxvPVswXTtjb250aW51ZTtjYXNlIDc6bz1zLm9wcy5wb3AoKSxzLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKGk9cy50cnlzLChpPWkubGVuZ3RoPjAmJmlbaS5sZW5ndGgtMV0pfHw2IT09b1swXSYmMiE9PW9bMF0pKXtzPTA7Y29udGludWV9aWYoMz09PW9bMF0mJighaXx8b1sxXT5pWzBdJiZvWzFdPGlbM10pKXtzLmxhYmVsPW9bMV07YnJlYWt9aWYoNj09PW9bMF0mJnMubGFiZWw8aVsxXSl7cy5sYWJlbD1pWzFdLGk9bzticmVha31pZihpJiZzLmxhYmVsPGlbMl0pe3MubGFiZWw9aVsyXSxzLm9wcy5wdXNoKG8pO2JyZWFrfWlbMl0mJnMub3BzLnBvcCgpLHMudHJ5cy5wb3AoKTtjb250aW51ZX1vPXQuY2FsbChlLHMpfWNhdGNoKGUpe289WzYsZV0scj0wfWZpbmFsbHl7bj1pPTB9aWYoNSZvWzBdKXRocm93IG9bMV07cmV0dXJue3ZhbHVlOm9bMF0/b1sxXTp2b2lkIDAsZG9uZTohMH19KFtvLGNdKX19fSxjPSJ3c3M6Ly9hd3MtdXMtZWFzdC0yLmFkYW1hLXBsYXRmb3JtLmNvbS9zIix1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3RoaXMudHJlZT17fSx0aGlzLmRpc3BhdGNoPXt9LHRoaXMuZGlzcGF0Y2hfY291bnQ9MCx0aGlzLnF1ZXVlPVtdLHRoaXMub25kZWNpZGU9ZnVuY3Rpb24oZSl7fX1yZXR1cm4gZS5wcm90b3R5cGUuX19yZWNBcHBlbmRDaGFuZ2U9ZnVuY3Rpb24oZSx0LG4pe2lmKCJvYmplY3QiPT10eXBlb2YgdClmb3IodmFyIHIgaW4gdClyIGluIGV8fChlW3JdPXt9KSx0aGlzLl9fcmVjQXBwZW5kQ2hhbmdlKGVbcl0sdFtyXSxuKTtlbHNlImZ1bmN0aW9uIj09dHlwZW9mIHQmJigiQGUiaW4gZXx8KGVbIkBlIl09W10pLGVbIkBlIl0ucHVzaCh7Y2I6dCxvcmRlcjpufSkpfSxlLnByb3RvdHlwZS5vblRyZWVDaGFuZ2U9ZnVuY3Rpb24oZSl7dGhpcy5fX3JlY0FwcGVuZENoYW5nZSh0aGlzLmRpc3BhdGNoLGUsdGhpcy5kaXNwYXRjaF9jb3VudCksdGhpcy5kaXNwYXRjaF9jb3VudCsrfSxlLnByb3RvdHlwZS5tZXJnZVVwZGF0ZT1mdW5jdGlvbihlKXsiZGF0YSJpbiBlJiZ0aGlzLl9fcmVjTWVyZ2VBbmREaXNwYXRjaCh0aGlzLnRyZWUsdGhpcy5kaXNwYXRjaCxlLmRhdGEpLCJvdXRzdGFuZGluZyJpbiBlJiZ0aGlzLm9uZGVjaWRlKGUub3V0c3RhbmRpbmcpLHRoaXMuX19kcmFpbigpfSxlLnByb3RvdHlwZS5fX3JlY0RlbGV0ZUFuZERpc3BhdGNoPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuIGluIGUpe3ZhciByPWVbbl07QXJyYXkuaXNBcnJheShyKXx8biBpbiB0JiZ0aGlzLl9fcmVjRGVsZXRlQW5kRGlzcGF0Y2gocix0W25dKTt2YXIgaT0iLSIrbjtudWxsIT10JiZpIGluIHQmJnRoaXMuX19maXJlKHRbaV0se2tleTpuLGJlZm9yZTpyLHZhbHVlOm51bGx9KX19LGUucHJvdG90eXBlLl9fcmVjTWVyZ2VBbmREaXNwYXRjaD1mdW5jdGlvbihlLHQsbil7Zm9yKHZhciByIGluIG4pe3ZhciBpPW5bcl07aWYobnVsbCE9PWkpe3ZhciBvPSEociBpbiBlKTtpZigib2JqZWN0Ij09dHlwZW9mIGkpe3ZhciBzPSJAbyJpbiBpfHwiQHMiaW4gaTtyIGluIGV8fChzPyhlW3JdPVtdLGVbIiMiK3JdPXt9KTplW3JdPXt9KSwocz1BcnJheS5pc0FycmF5KGVbcl0pfHxzKT90aGlzLl9fcmVjTWVyZ2VBbmREaXNwYXRjaEFycmF5KGVbcl0sbnVsbCE9dCYmciBpbiB0P3Rbcl06bnVsbCxlWyIjIityXSxpKTp0aGlzLl9fcmVjTWVyZ2VBbmREaXNwYXRjaChlW3JdLG51bGwhPXQmJnIgaW4gdD90W3JdOm51bGwsaSl9ZWxzZXt2YXIgYz1yIGluIGU/ZVtyXTpudWxsO2Vbcl09aSxudWxsIT10JiZyIGluIHQmJnRoaXMuX19maXJlKHRbcl0se2tleTpyLGJlZm9yZTpjLHZhbHVlOml9KX1pZihvKXt2YXIgdT0iKyIrcjtudWxsIT10JiZ1IGluIHQmJnRoaXMuX19maXJlKHRbdV0se2tleTpyLHZhbHVlOmVbcl19KX1udWxsIT10JiYiQGUiaW4gdCYmdGhpcy5fX2ZpcmUodCx7dmFsdWU6ZX0pfWVsc2V7dmFyIGQ9Ii0iK3IsYT1lW3JdO2lmKG51bGwhPXQmJmQgaW4gdCYmdGhpcy5fX2ZpcmUodFtkXSx7a2V5OnIsYmVmb3JlOmEsdmFsdWU6bnVsbH0pLEFycmF5LmlzQXJyYXkoYSkpe3ZhciBoPSIjIityO2ggaW4gZSYmaCBpbiB0JiZ0aGlzLl9fcmVjRGVsZXRlQW5kRGlzcGF0Y2goZVtoXSx0W2hdKSxkZWxldGUgZVsiIyIrcl19ciBpbiBlJiZyIGluIHQmJnRoaXMuX19yZWNEZWxldGVBbmREaXNwYXRjaChlW3JdLHRbcl0pLGRlbGV0ZSBlW3JdLG51bGwhPXQmJnIgaW4gdCYmdGhpcy5fX2ZpcmUodFtyXSx7a2V5OnIsYmVmb3JlOmEsdmFsdWU6bnVsbH0pfX19LGUucHJvdG90eXBlLl9fcmVjTWVyZ2VBbmREaXNwYXRjaEFycmF5PWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpPW51bGwsbz1udWxsO2Zvcih2YXIgcyBpbiByKWlmKCJAbyI9PXMpaT1yW3NdO2Vsc2UgaWYoIkBzIj09cylvPXJbc107ZWxzZSBpZihudWxsPT1yW3NdKXQmJiItImluIHQmJnRoaXMuX19maXJlKHRbIi0iXSx7a2V5OnMsYmVmb3JlOm5bc10sdmFsdWU6bnVsbH0pLGRlbGV0ZSBuW3NdO2Vsc2V7dmFyIGM9ITE7bnVsbCE9biYmcyBpbiBufHwodCYmIisiaW4gdCYmKGM9ITApLG5bc109e30pLHRoaXMuX19yZWNNZXJnZUFuZERpc3BhdGNoKG5bc10sbnVsbCE9dCYmIiMiaW4gdD90WyIjIl06bnVsbCxyW3NdKSxjJiZ0aGlzLl9fZmlyZSh0WyIrIl0se2tleTpzLGJlZm9yZTpudWxsLHZhbHVlOm5bc119KX12YXIgdT17YmVmb3JlOmUsdmFsdWU6ZX07aWYobnVsbCE9PW8pe3UuYmVmb3JlPVtdO2Zvcih2YXIgZD0wO2Q8ZS5sZW5ndGg7ZCsrKXUuYmVmb3JlLnB1c2goZVtkXSk7ZS5sZW5ndGg9b31pZihudWxsIT09aSl7dmFyIGE9W107dS5iZWZvcmU9W107dmFyIGg9ISF0JiYiLSJpbiB0O2ZvcihkPTA7ZDxlLmxlbmd0aDtkKyspdS5iZWZvcmUucHVzaChlW2RdKSxoJiYoZVtkXS5fX2tpbGw9ITApO2ZvcihkPTA7ZDxpLmxlbmd0aDtkKyspe3ZhciBwPWlbZF0sZj10eXBlb2YgcDtpZigic3RyaW5nIj09Znx8Im51bWJlciI9PWYpYS5wdXNoKG5bcF0pLGgmJihuW3BdLl9fa2lsbD0hMSk7ZWxzZSBmb3IodmFyIGw9cFswXSxfPXBbMV0seT1sO3k8PV87eSsrKWgmJihlW3ldLl9fa2lsbD0hMSksYS5wdXNoKGVbeV0pfWlmKGgpZm9yKHMgaW4gbiluW3NdLl9fa2lsbCYmKHMgaW4gdCYmdGhpcy5fX3JlY0RlbGV0ZUFuZERpc3BhdGNoKG5bc10sdFtzXSksdGhpcy5fX2ZpcmUodFsiLSJdLHtrZXk6cyxiZWZvcmU6bltzXSx2YWx1ZTpudWxsfSkpLGRlbGV0ZSBuW3NdLl9fa2lsbDtlLmxlbmd0aD1hLmxlbmd0aDtmb3IoZD0wO2Q8YS5sZW5ndGg7ZCsrKWVbZF09YVtkXX10aGlzLl9fZmlyZSh0LHUpfSxlLnByb3RvdHlwZS5fX2ZpcmU9ZnVuY3Rpb24oZSx0KXtpZihlJiYiQGUiaW4gZSl7Zm9yKHZhciBuPWVbIkBlIl0scj0wLGk9MDtpPG4ubGVuZ3RoO2krKyl7dmFyIG89bltpXTtudWxsIT09bz90aGlzLnF1ZXVlLnB1c2goe2NiOm8uY2Isb3JkZXI6by5vcmRlcixjaGFuZ2U6dCxkaXNwYXRjaF9saXN0Om4saW5kZXg6aX0pOnIrK31pZihyPjApe3ZhciBzPVtdO2ZvcihpPTA7aTxuLmxlbmd0aDtpKyspbnVsbCE9PW8mJnMucHVzaChvKTtlWyJAZSJdPXN9fX0sZS5wcm90b3R5cGUuX19kcmFpbj1mdW5jdGlvbigpe3RoaXMucXVldWUuc29ydCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5vcmRlci10Lm9yZGVyfSkpO2Zvcih2YXIgZT0wO2U8dGhpcy5xdWV1ZS5sZW5ndGg7ZSsrKXt2YXIgdD10aGlzLnF1ZXVlW2VdOyJkZWxldGUiPT09dC5jYih0LmNoYW5nZSkmJih0LmRpc3BhdGNoX2xpc3RbdC5pbmRleF09bnVsbCl9dGhpcy5xdWV1ZT1bXX0sZX0oKSxkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLnByZWZpeD1lfXJldHVybiBlLnByb3RvdHlwZS5mYWlsdXJlPWZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKHRoaXMucHJlZml4KyJ8ZXJyb3IiK2UpfSxlLnByb3RvdHlwZS5zdWNjZXNzPWZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKHRoaXMucHJlZml4KyJ8c3VjY2VzcztzZXE9IitlLnNlcSl9LGV9KCksYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7dGhpcy50cmVlPWV9cmV0dXJuIGUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oZSl7dGhpcy50cmVlLm1lcmdlVXBkYXRlKGUuZGVsdGEpfSxlLnByb3RvdHlwZS5mYWlsdXJlPWZ1bmN0aW9uKGUpe2NvbnNvbGUubG9nKCJ0cmVlfGZhaWx1cmU9IitlKX0sZS5wcm90b3R5cGUuY29tcGxldGU9ZnVuY3Rpb24oKXt9LGV9KCksaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7dGhpcy5iYWNrb2ZmPTEsdGhpcy51cmw9ZSx0aGlzLmNvbm5lY3RlZD0hMSx0aGlzLmRlYWQ9ITEsdGhpcy5tYXhpbXVtX2JhY2tvZmY9MjUwMCx0aGlzLnNvY2tldD1udWxsLHRoaXMub25zdGF0dXNjaGFuZ2U9ZnVuY3Rpb24oZSl7fSx0aGlzLm9ucGluZz1mdW5jdGlvbihlLHQpe30sdGhpcy5vbmF1dGhuZWVkZWQ9ZnVuY3Rpb24oZSl7fSx0aGlzLnNjaGVkdWxlZD0hMSx0aGlzLmNhbGxiYWNrcz1uZXcgTWFwLHRoaXMubmV4dElkPTAsdGhpcy5vbnJlY29ubmVjdD1uZXcgTWFwLHRoaXMucnBjaWQ9MSx0aGlzLnNlc3Npb25JZD0iIix0aGlzLnNlbmRJZD0wfXJldHVybiBlLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7dGhpcy5kZWFkPSEwLG51bGwhPT10aGlzLnNvY2tldCYmdGhpcy5zb2NrZXQuY2xvc2UoKX0sZS5wcm90b3R5cGUuX3JldHJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5zb2NrZXQ9bnVsbCx0aGlzLmNvbm5lY3RlZCYmKHRoaXMuY29ubmVjdGVkPSExLHRoaXMub25zdGF0dXNjaGFuZ2UoITEpKSx0aGlzLmNhbGxiYWNrcy5jbGVhcigpLCF0aGlzLmRlYWQmJiF0aGlzLnNjaGVkdWxlZCl7dmFyIGU9ITE7dGhpcy5iYWNrb2ZmKz1NYXRoLnJhbmRvbSgpKnRoaXMuYmFja29mZix0aGlzLmJhY2tvZmY+dGhpcy5tYXhpbXVtX2JhY2tvZmYmJih0aGlzLmJhY2tvZmY9dGhpcy5tYXhpbXVtX2JhY2tvZmYsZT0hMCksdGhpcy5zY2hlZHVsZWQ9ITA7dmFyIHQ9dGhpcztzZXRUaW1lb3V0KChmdW5jdGlvbigpe3Quc3RhcnQoKX0pLHRoaXMuYmFja29mZiksZSYmKHRoaXMuYmFja29mZi89Mil9fSxlLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5zY2hlZHVsZWQ9ITEsdGhpcy5kZWFkPSExLHRoaXMuc29ja2V0PW5ldyBpLmEodGhpcy51cmwpLHRoaXMuc29ja2V0Lm9ubWVzc2FnZT1mdW5jdGlvbih0KXt2YXIgbj1KU09OLnBhcnNlKHQuZGF0YSk7aWYoInBpbmciaW4gbilyZXR1cm4gZS5vbnBpbmcobi5waW5nLG4ubGF0ZW5jeSksbi5wb25nPShuZXcgRGF0ZSkuZ2V0VGltZSgpLzFlMyx2b2lkIGUuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkobikpO2lmKCJzdGF0dXMiaW4gbilyZXR1cm4iY29ubmVjdGVkIiE9bi5zdGF0dXM/KGUuZGVhZD0hMCxlLnNvY2tldC5jbG9zZSgpLGUuc29ja2V0PW51bGwsdm9pZCBlLm9uYXV0aG5lZWRlZCgoZnVuY3Rpb24oKXtlLnN0YXJ0KCl9KSkpOihlLmJhY2tvZmY9MSxlLmNvbm5lY3RlZD0hMCxlLnNlc3Npb25JZD1uLnNlc3Npb25faWQsZS5vbnN0YXR1c2NoYW5nZSghMCksdm9pZCBlLl9yZWNvbm5lY3QoKSk7aWYoImZhaWx1cmUiaW4gbillLmNhbGxiYWNrcy5oYXMobi5mYWlsdXJlKSYmKHI9ZS5jYWxsYmFja3MuZ2V0KG4uZmFpbHVyZSkpJiYoZS5jYWxsYmFja3MuZGVsZXRlKG4uZmFpbHVyZSkscihuKSk7ZWxzZSBpZigiZGVsaXZlciJpbiBuKXt2YXIgcjtpZihlLmNhbGxiYWNrcy5oYXMobi5kZWxpdmVyKSkocj1lLmNhbGxiYWNrcy5nZXQobi5kZWxpdmVyKSkmJihuLmRvbmUmJmUuY2FsbGJhY2tzLmRlbGV0ZShuLmRlbGl2ZXIpLHIobikpfX0sdGhpcy5zb2NrZXQub25jbG9zZT1mdW5jdGlvbih0KXtlLl9yZXRyeSgpfSx0aGlzLnNvY2tldC5vbmVycm9yPWZ1bmN0aW9uKHQpe2UuX3JldHJ5KCl9fSxlLnByb3RvdHlwZS5fd3JpdGU9ZnVuY3Rpb24oZSx0KXtpZih0aGlzLmNvbm5lY3RlZCl7dmFyIG49dGhpcy5ycGNpZDt0aGlzLnJwY2lkKyssZS5pZD1uLHRoaXMuY2FsbGJhY2tzLnNldChuLHQpLHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZSkpfWVsc2UgdCh7ZmFpbHVyZTo2MDAscmVhc29uOjk5OTl9KX0sZS5wcm90b3R5cGUud2FpdF9jb25uZWN0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gbyh0aGlzLHZvaWQgMCx2b2lkIDAsKGZ1bmN0aW9uKCl7dmFyIGUsdDtyZXR1cm4gcyh0aGlzLChmdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5jb25uZWN0ZWQ/WzIsbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUpe2UoITApfSkpXTooZT10aGlzLHQ9dGhpcy5vbnN0YXR1c2NoYW5nZSxbMixuZXcgUHJvbWlzZSgoZnVuY3Rpb24obil7ZS5vbnN0YXR1c2NoYW5nZT1mdW5jdGlvbihyKXt0KHIpLHImJihuKCEwKSxlLm9uc3RhdHVzY2hhbmdlPXQpfX0pKV0pfSkpfSkpfSxlLnByb3RvdHlwZS5fcmVjb25uZWN0PWZ1bmN0aW9uKCl7dGhpcy5vbnJlY29ubmVjdC5mb3JFYWNoKChmdW5jdGlvbihlLHQpe2UuX19yZXRyeSgpfSkpfSxlLnByb3RvdHlwZS5fX2V4ZWN1dGVfcnI9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztyZXR1cm4gZS5maXJzdD0hMCx0Ll93cml0ZShlLnJlcXVlc3QsKGZ1bmN0aW9uKG4pe2UuZmlyc3QmJihlLmZpcnN0PSExLCJmYWlsdXJlImluIG4/ZS5yZXNwb25kZXIuZmFpbHVyZShuLnJlYXNvbik6ZS5yZXNwb25kZXIuc3VjY2VzcyhuLnJlc3BvbnNlKSksdC5vbnJlY29ubmVjdC5kZWxldGUoZS5pZCl9KSksdC5vbnJlY29ubmVjdC5zZXQoZS5pZCxlKSxlLl9fcmV0cnk9ZnVuY3Rpb24oKXt0Ll9fZXhlY3V0ZV9ycihlKX0sZX0sZS5wcm90b3R5cGUuX19leGVjdXRlX3N0cmVhbT1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3JldHVybiB0Ll93cml0ZShlLnJlcXVlc3QsKGZ1bmN0aW9uKG4pe2lmKCJmYWlsdXJlImluIG4pcmV0dXJuIGUucmVzcG9uZGVyLmZhaWx1cmUobi5yZWFzb24pLHZvaWQgdC5vbnJlY29ubmVjdC5kZWxldGUoZS5pZCk7bi5yZXNwb25zZSYmZS5yZXNwb25kZXIubmV4dChuLnJlc3BvbnNlKSxuLmRvbmUmJihlLnJlc3BvbmRlci5jb21wbGV0ZSgpLHQub25yZWNvbm5lY3QuZGVsZXRlKGUuaWQpKX0pKSx0Lm9ucmVjb25uZWN0LnNldChlLmlkLGUpLGUuX19yZXRyeT1mdW5jdGlvbigpe3QuX19leGVjdXRlX3N0cmVhbShlKX0sZX0sZS5wcm90b3R5cGUuSW5pdFNldHVwQWNjb3VudD1mdW5jdGlvbihlLHQpe3RoaXMubmV4dElkKys7dmFyIG49dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3JyKHtpZDpuLHJlc3BvbmRlcjp0LHJlcXVlc3Q6e21ldGhvZDoiaW5pdC9zZXR1cC1hY2NvdW50IixpZDpuLGVtYWlsOmV9fSl9LGUucHJvdG90eXBlLkluaXRDb21wbGV0ZUFjY291bnQ9ZnVuY3Rpb24oZSx0LG4scil7dGhpcy5uZXh0SWQrKzt2YXIgaT10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOmkscmVzcG9uZGVyOnIscmVxdWVzdDp7bWV0aG9kOiJpbml0L2NvbXBsZXRlLWFjY291bnQiLGlkOmksZW1haWw6ZSxyZXZva2U6dCxjb2RlOm59fSl9LGUucHJvdG90eXBlLkFjY291bnRTZXRQYXNzd29yZD1mdW5jdGlvbihlLHQsbil7dGhpcy5uZXh0SWQrKzt2YXIgcj10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOnIscmVzcG9uZGVyOm4scmVxdWVzdDp7bWV0aG9kOiJhY2NvdW50L3NldC1wYXNzd29yZCIsaWQ6cixpZGVudGl0eTplLHBhc3N3b3JkOnR9fSl9LGUucHJvdG90eXBlLkFjY291bnRMb2dpbj1mdW5jdGlvbihlLHQsbil7dGhpcy5uZXh0SWQrKzt2YXIgcj10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOnIscmVzcG9uZGVyOm4scmVxdWVzdDp7bWV0aG9kOiJhY2NvdW50L2xvZ2luIixpZDpyLGVtYWlsOmUscGFzc3dvcmQ6dH19KX0sZS5wcm90b3R5cGUuUHJvYmU9ZnVuY3Rpb24oZSx0KXt0aGlzLm5leHRJZCsrO3ZhciBuPXRoaXMubmV4dElkO3JldHVybiB0aGlzLl9fZXhlY3V0ZV9ycih7aWQ6bixyZXNwb25kZXI6dCxyZXF1ZXN0OnttZXRob2Q6InByb2JlIixpZDpuLGlkZW50aXR5OmV9fSl9LGUucHJvdG90eXBlLkF1dGhvcml0eUNyZWF0ZT1mdW5jdGlvbihlLHQpe3RoaXMubmV4dElkKys7dmFyIG49dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3JyKHtpZDpuLHJlc3BvbmRlcjp0LHJlcXVlc3Q6e21ldGhvZDoiYXV0aG9yaXR5L2NyZWF0ZSIsaWQ6bixpZGVudGl0eTplfX0pfSxlLnByb3RvdHlwZS5BdXRob3JpdHlTZXQ9ZnVuY3Rpb24oZSx0LG4scil7dGhpcy5uZXh0SWQrKzt2YXIgaT10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOmkscmVzcG9uZGVyOnIscmVxdWVzdDp7bWV0aG9kOiJhdXRob3JpdHkvc2V0IixpZDppLGlkZW50aXR5OmUsYXV0aG9yaXR5OnQsImtleS1zdG9yZSI6bn19KX0sZS5wcm90b3R5cGUuQXV0aG9yaXR5R2V0PWZ1bmN0aW9uKGUsdCxuKXt0aGlzLm5leHRJZCsrO3ZhciByPXRoaXMubmV4dElkO3JldHVybiB0aGlzLl9fZXhlY3V0ZV9ycih7aWQ6cixyZXNwb25kZXI6bixyZXF1ZXN0OnttZXRob2Q6ImF1dGhvcml0eS9nZXQiLGlkOnIsaWRlbnRpdHk6ZSxhdXRob3JpdHk6dH19KX0sZS5wcm90b3R5cGUuQXV0aG9yaXR5TGlzdD1mdW5jdGlvbihlLHQpe3RoaXMubmV4dElkKys7dmFyIG49dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3N0cmVhbSh7aWQ6bixyZXNwb25kZXI6dCxyZXF1ZXN0OnttZXRob2Q6ImF1dGhvcml0eS9saXN0IixpZDpuLGlkZW50aXR5OmV9fSl9LGUucHJvdG90eXBlLkF1dGhvcml0eURlc3Ryb3k9ZnVuY3Rpb24oZSx0LG4pe3RoaXMubmV4dElkKys7dmFyIHI9dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3JyKHtpZDpyLHJlc3BvbmRlcjpuLHJlcXVlc3Q6e21ldGhvZDoiYXV0aG9yaXR5L2Rlc3Ryb3kiLGlkOnIsaWRlbnRpdHk6ZSxhdXRob3JpdHk6dH19KX0sZS5wcm90b3R5cGUuU3BhY2VDcmVhdGU9ZnVuY3Rpb24oZSx0LG4pe3RoaXMubmV4dElkKys7dmFyIHI9dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3JyKHtpZDpyLHJlc3BvbmRlcjpuLHJlcXVlc3Q6e21ldGhvZDoic3BhY2UvY3JlYXRlIixpZDpyLGlkZW50aXR5OmUsc3BhY2U6dH19KX0sZS5wcm90b3R5cGUuU3BhY2VVc2FnZT1mdW5jdGlvbihlLHQsbixyKXt0aGlzLm5leHRJZCsrO3ZhciBpPXRoaXMubmV4dElkO3JldHVybiB0aGlzLl9fZXhlY3V0ZV9zdHJlYW0oe2lkOmkscmVzcG9uZGVyOnIscmVxdWVzdDp7bWV0aG9kOiJzcGFjZS91c2FnZSIsaWQ6aSxpZGVudGl0eTplLHNwYWNlOnQsbGltaXQ6bn19KX0sZS5wcm90b3R5cGUuU3BhY2VHZXQ9ZnVuY3Rpb24oZSx0LG4pe3RoaXMubmV4dElkKys7dmFyIHI9dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3JyKHtpZDpyLHJlc3BvbmRlcjpuLHJlcXVlc3Q6e21ldGhvZDoic3BhY2UvZ2V0IixpZDpyLGlkZW50aXR5OmUsc3BhY2U6dH19KX0sZS5wcm90b3R5cGUuU3BhY2VTZXQ9ZnVuY3Rpb24oZSx0LG4scil7dGhpcy5uZXh0SWQrKzt2YXIgaT10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOmkscmVzcG9uZGVyOnIscmVxdWVzdDp7bWV0aG9kOiJzcGFjZS9zZXQiLGlkOmksaWRlbnRpdHk6ZSxzcGFjZTp0LHBsYW46bn19KX0sZS5wcm90b3R5cGUuU3BhY2VEZWxldGU9ZnVuY3Rpb24oZSx0LG4pe3RoaXMubmV4dElkKys7dmFyIHI9dGhpcy5uZXh0SWQ7cmV0dXJuIHRoaXMuX19leGVjdXRlX3JyKHtpZDpyLHJlc3BvbmRlcjpuLHJlcXVlc3Q6e21ldGhvZDoic3BhY2UvZGVsZXRlIixpZDpyLGlkZW50aXR5OmUsc3BhY2U6dH19KX0sZS5wcm90b3R5cGUuU3BhY2VTZXRSb2xlPWZ1bmN0aW9uKGUsdCxuLHIsaSl7dGhpcy5uZXh0SWQrKzt2YXIgbz10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOm8scmVzcG9uZGVyOmkscmVxdWVzdDp7bWV0aG9kOiJzcGFjZS9zZXQtcm9sZSIsaWQ6byxpZGVudGl0eTplLHNwYWNlOnQsZW1haWw6bixyb2xlOnJ9fSl9LGUucHJvdG90eXBlLlNwYWNlUmVmbGVjdD1mdW5jdGlvbihlLHQsbixyKXt0aGlzLm5leHRJZCsrO3ZhciBpPXRoaXMubmV4dElkO3JldHVybiB0aGlzLl9fZXhlY3V0ZV9ycih7aWQ6aSxyZXNwb25kZXI6cixyZXF1ZXN0OnttZXRob2Q6InNwYWNlL3JlZmxlY3QiLGlkOmksaWRlbnRpdHk6ZSxzcGFjZTp0LGtleTpufX0pfSxlLnByb3RvdHlwZS5TcGFjZUxpc3Q9ZnVuY3Rpb24oZSx0LG4scil7dGhpcy5uZXh0SWQrKzt2YXIgaT10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfc3RyZWFtKHtpZDppLHJlc3BvbmRlcjpyLHJlcXVlc3Q6e21ldGhvZDoic3BhY2UvbGlzdCIsaWQ6aSxpZGVudGl0eTplLG1hcmtlcjp0LGxpbWl0Om59fSl9LGUucHJvdG90eXBlLkRvY3VtZW50Q3JlYXRlPWZ1bmN0aW9uKGUsdCxuLHIsaSxvKXt0aGlzLm5leHRJZCsrO3ZhciBzPXRoaXMubmV4dElkO3JldHVybiB0aGlzLl9fZXhlY3V0ZV9ycih7aWQ6cyxyZXNwb25kZXI6byxyZXF1ZXN0OnttZXRob2Q6ImRvY3VtZW50L2NyZWF0ZSIsaWQ6cyxpZGVudGl0eTplLHNwYWNlOnQsa2V5Om4sZW50cm9weTpyLGFyZzppfX0pfSxlLnByb3RvdHlwZS5Eb2N1bWVudExpc3Q9ZnVuY3Rpb24oZSx0LG4scixpKXt0aGlzLm5leHRJZCsrO3ZhciBvPXRoaXMubmV4dElkO3JldHVybiB0aGlzLl9fZXhlY3V0ZV9zdHJlYW0oe2lkOm8scmVzcG9uZGVyOmkscmVxdWVzdDp7bWV0aG9kOiJkb2N1bWVudC9saXN0IixpZDpvLGlkZW50aXR5OmUsc3BhY2U6dCxtYXJrZXI6bixsaW1pdDpyfX0pfSxlLnByb3RvdHlwZS5Db25uZWN0aW9uQ3JlYXRlPWZ1bmN0aW9uKGUsdCxuLHIsaSl7dmFyIG89dGhpcztvLm5leHRJZCsrO3ZhciBzPW8ubmV4dElkO3JldHVybiBvLl9fZXhlY3V0ZV9zdHJlYW0oe2lkOnMscmVzcG9uZGVyOmkscmVxdWVzdDp7bWV0aG9kOiJjb25uZWN0aW9uL2NyZWF0ZSIsaWQ6cyxpZGVudGl0eTplLHNwYWNlOnQsa2V5Om4sInZpZXdlci1zdGF0ZSI6cn0sc2VuZDpmdW5jdGlvbihlLHQsbil7by5uZXh0SWQrKzt2YXIgcj1vLm5leHRJZCxpPXM7by5fX2V4ZWN1dGVfcnIoe2lkOnIscmVzcG9uZGVyOm4scmVxdWVzdDp7bWV0aG9kOiJjb25uZWN0aW9uL3NlbmQiLGlkOnIsY29ubmVjdGlvbjppLGNoYW5uZWw6ZSxtZXNzYWdlOnR9fSl9LHVwZGF0ZTpmdW5jdGlvbihlLHQpe28ubmV4dElkKys7dmFyIG49by5uZXh0SWQscj1zO28uX19leGVjdXRlX3JyKHtpZDpuLHJlc3BvbmRlcjp0LHJlcXVlc3Q6e21ldGhvZDoiY29ubmVjdGlvbi91cGRhdGUiLGlkOm4sY29ubmVjdGlvbjpyLCJ2aWV3ZXItc3RhdGUiOmV9fSl9LGVuZDpmdW5jdGlvbihlKXtvLm5leHRJZCsrO3ZhciB0PW8ubmV4dElkLG49cztvLl9fZXhlY3V0ZV9ycih7aWQ6dCxyZXNwb25kZXI6ZSxyZXF1ZXN0OnttZXRob2Q6ImNvbm5lY3Rpb24vZW5kIixpZDp0LGNvbm5lY3Rpb246bn19KX19KX0sZS5wcm90b3R5cGUuQ29uZmlndXJlTWFrZU9yR2V0QXNzZXRLZXk9ZnVuY3Rpb24oZSl7dGhpcy5uZXh0SWQrKzt2YXIgdD10aGlzLm5leHRJZDtyZXR1cm4gdGhpcy5fX2V4ZWN1dGVfcnIoe2lkOnQscmVzcG9uZGVyOmUscmVxdWVzdDp7bWV0aG9kOiJjb25maWd1cmUvbWFrZS1vci1nZXQtYXNzZXQta2V5IixpZDp0fX0pfSxlLnByb3RvdHlwZS5BdHRhY2htZW50U3RhcnQ9ZnVuY3Rpb24oZSx0LG4scixpLG8pe3ZhciBzPXRoaXM7cy5uZXh0SWQrKzt2YXIgYz1zLm5leHRJZDtyZXR1cm4gcy5fX2V4ZWN1dGVfc3RyZWFtKHtpZDpjLHJlc3BvbmRlcjpvLHJlcXVlc3Q6e21ldGhvZDoiYXR0YWNobWVudC9zdGFydCIsaWQ6YyxpZGVudGl0eTplLHNwYWNlOnQsa2V5Om4sZmlsZW5hbWU6ciwiY29udGVudC10eXBlIjppfSxhcHBlbmQ6ZnVuY3Rpb24oZSx0LG4pe3MubmV4dElkKys7dmFyIHI9cy5uZXh0SWQsaT1jO3MuX19leGVjdXRlX3JyKHtpZDpyLHJlc3BvbmRlcjpuLHJlcXVlc3Q6e21ldGhvZDoiYXR0YWNobWVudC9hcHBlbmQiLGlkOnIsdXBsb2FkOmksImNodW5rLW1kNSI6ZSwiYmFzZTY0LWJ5dGVzIjp0fX0pfSxmaW5pc2g6ZnVuY3Rpb24oZSl7cy5uZXh0SWQrKzt2YXIgdD1zLm5leHRJZCxuPWM7cy5fX2V4ZWN1dGVfcnIoe2lkOnQscmVzcG9uZGVyOmUscmVxdWVzdDp7bWV0aG9kOiJhdHRhY2htZW50L2ZpbmlzaCIsaWQ6dCx1cGxvYWQ6bn19KX19KX0sZX0oKX0sZnVuY3Rpb24oZSx0KXt2YXIgbjtuPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCk7dHJ5e249bnx8bmV3IEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCl9Y2F0Y2goZSl7Im9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJihuPXdpbmRvdyl9ZS5leHBvcnRzPW59XSl9KSk7");
}
